# Handoff — 2026-01-22

## Samenvatting

CTO-level review van software stack + updates aan BMAD tooling voor eerlijkere scoring en fix-loops.

---

## Gedaan

### 1. UNIVERSAL_CTO_REPO_SCAN_PROMPT v2.0

**Bestand:** `UNIVERSAL_CTO_REPO_SCAN_PROMPT_v2.md`

**Wijzigingen:**
- P1 gesplitst in **P1-CRITICAL** (-1.0) en **P1-QUICK** (-0.5)
- Decision tree toegevoegd voor classificatie
- Tijd-schattingen verwijderd (clouded LLM judgment)
- GDPR/compliance verwijderd (blijft leuk)

**Nieuwe score formule:**
```
Score = 10 - (P1_CRITICAL × 1.0) - (P1_QUICK × 0.5) - (P2 × 0.5) - (P3 × 0.25)
```

---

### 2. bmad-bundle Skill (Claude Code)

**Bestand:** `skills/bmad-bundle/SKILL.md`

**Wijzigingen:**
- Workflow uitgebreid van 6 → 8 stappen
- **CTO Story Scan** toegevoegd (stap 4) - check story INHOUD op P1 risico's
- **CTO Repo Scan** toegevoegd (stap 8) - delta-check na development
- **Fix-loops** op elke gate: IDENTIFY → FIX → RESCAN → CONTINUE
- "STOP" vervangen door "FIX" - nooit wachten, altijd repareren

**Nieuwe workflow:**
```
1. Worktree setup
2. Repo sanity (CTO_RULES.md check)
3. RUN1 (story generatie)
4. CTO Story Scan (fix-loop)      ← NIEUW
5. CTO Guard (fix-loop)
6. Preflight (fix-loop)
7. RUN2 (Ralph Loop)
8. CTO Repo Scan (delta-check)    ← NIEUW
```

---

### 3. plan-to-bmad Skill (Claude Code)

**Bestand:** `skills/plan-to-bmad/SKILL.md`

**Wijzigingen:**
- **Twee modi** toegevoegd:
  - Modus 1: Direct onderzoek (`/plan-to-bmad "beschrijving"`)
  - Modus 2: Vanuit bestaand plan (`/plan-to-bmad <path>`)
- Onderzoek checklist toegevoegd
- P1 risico identificatie (Security/Data Loss/Architecture)
- CTO Rules check in output format

---

### 4. plan-to-bmad voor Codex

**Bestand:** `bmad_autopilot_kit_codex/PLAN_TO_BMAD_PROMPT_codex.md` (NIEUW)

**Doel:** Zelfde functionaliteit als Claude Code skill, maar als Codex prompt.

**Gebruik:**
```bash
# Optie 1: Plak in interactieve sessie
codex
> [plak inhoud PLAN_TO_BMAD_PROMPT_codex.md]

# Optie 2: Als custom prompt
cp PLAN_TO_BMAD_PROMPT_codex.md ~/.codex/prompts/plan-to-bmad.md
codex
> /prompts:plan-to-bmad

# Optie 3: Non-interactief
cat PLAN_TO_BMAD_PROMPT_codex.md | codex exec -C /repo -
```

**README geüpdatet:** `bmad_autopilot_kit_codex/README_codex.md`

---

### 5. Skills gesynchroniseerd naar ai-stack

```
ai-stack/skills/
├── bmad-bundle/
│   ├── SKILL.md
│   └── knowledge/
│       ├── code-patterns.md
│       └── violation-detection.md
└── plan-to-bmad/
    ├── SKILL.md
    └── knowledge/
        └── bmad-template.md
```

---

## Niet gedaan

| Item | Reden |
|------|-------|
| Externe verwijzing naar CTO scan in bmad-bundle | Gebruiker: "nee dat wil ik nog even niet" |
| GDPR compliance in scoring | Gebruiker: "moet wel leuk blijven" |
| Tijd-schattingen (XS/S/M/L/XL) | Gebruiker: "clouds judgement van een LLM" |

---

## Verificatie

```bash
# Check nieuwe bestanden
ls -la ai-stack/skills/*/SKILL.md
ls -la ai-stack/bmad_autopilot_kit_codex/PLAN_TO_BMAD_PROMPT_codex.md
ls -la ai-stack/UNIVERSAL_CTO_REPO_SCAN_PROMPT_v2.md

# Test Claude Code skills (in to-do-jvdp)
# /plan-to-bmad "test feature"
# /bmad-bundle bmad_input/test.md
```

---

## Gerelateerde bestanden

| Bestand | Locatie |
|---------|---------|
| CTO Scan v2 | `ai-stack/UNIVERSAL_CTO_REPO_SCAN_PROMPT_v2.md` |
| bmad-bundle skill | `ai-stack/skills/bmad-bundle/SKILL.md` |
| plan-to-bmad skill | `ai-stack/skills/plan-to-bmad/SKILL.md` |
| Codex plan-to-bmad | `ai-stack/bmad_autopilot_kit_codex/PLAN_TO_BMAD_PROMPT_codex.md` |
| Codex README | `ai-stack/bmad_autopilot_kit_codex/README_codex.md` |
